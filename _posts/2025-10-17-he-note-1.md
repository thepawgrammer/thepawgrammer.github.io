---
title: 'I. Basic Math: A-1. Modulo Arithmetic'
date: 2025-10-17
# modified: 2025-10-24
use_math: true   # β† μ΄ μ¤„ μ¶”κ°€
permalink: /posts/2025/10/he-note-1/
tags:
  - modulo-arithmetic
  - cryptography
  - homomorphic-encryption
  - lattice-based-cryptography
---

<!-- λ°°λ„ μ΄λ―Έμ§€ + λ§ν¬ -->
<a href="https://arxiv.org/abs/2503.05136" target="_blank">
  <img src="/images/explorations/he-book/he-book-cover.png" alt="The Beginner's Textbook for Fully Homomorphic Encryption (by Ronny Ko)" style="width:100%; border-radius:10px; margin-bottom:20px;"/>
</a>

ν•΄λ‹Ή ν¬μ¤νΈλ” <strong>Ronny Ko</strong>μ μ €μ„ *The Beginner's Textbook for Fully Homomorphic Encryption*μ„ κΈ°λ°μΌλ΅ μ‘μ„±ν•μ€λ‹¤. μ΄λ² ν¬μ¤νΈμ—μ„λ” **'I. Basic Math: A-1. Modulo Arithmetic'** ννΈλ¥Ό μ”μ•½β€Άμ •λ¦¬ν•κ³ μ ν•λ‹¤.  

<details>
  <summary>
  <span style="font-size:1.25em; font-weight:bold;">
    A-1. Modulo Arithmetic (λ¨λ“λ¬ μ‚°μ )
  </span>
  </summary>
  <div markdown="1">

---

### 1) Overview
Reference: [Extended Euclidean Algorithm Tutorial](https://youtu.be/fz1vxq5ts5I?si=jy6LZ9QFcNHPlG-0)

<div style="margin-left:20px; border:2px solid #007acc; border-radius:6px; background:#f0f8ff; margin:12px 0; width:95%; font-size:0.95em;">

  <div style="background:#007acc; color:white; font-weight:bold; padding:8px 12px; border-radius:4px 4px 0 0;">
    π“ [Definition A-1.1] Integer Modulo (μ •μ λ¨λ“λ¬)
  </div>

  <div style="padding:12px 15px;" markdown="1">

  - **λ¨λ“λ¬ (modulo, mod)** λ€, ν• μλ¥Ό λ‹¤λ¥Έ μλ΅ λ‚λ λ• **λ‚λ¨Έμ§€λ¥Ό κ³„μ‚°ν•λ” μ—°μ‚°**μ„ μλ―Έν•λ‹¤.   
    - μμ‹μΌλ΅ ν‘ν„ν•λ©΄ λ‹¤μκ³Ό κ°™λ‹¤:
      $$
      A = BQ + R
      $$
      - $A$: ν”Όμ μ *(dividend)*, $B$: μ μ *(divisor)*
      - $Q$: λ« *(quotient)*, $R$: λ‚λ¨Έμ§€ *(remainder)*

      β†’ λ”°λΌμ„, 
      **"$A \bmod B = R$"** νΉμ€ **"$A$ modulo $B = R$"** λ΅ ν‘ν„ν•  μ μλ‹¤.

  - **$a \bmod q$ ( i.e., $a$ modulo $q$ ):** $a$λ¥Ό $q$λ΅ λ‚λ **λ‚λ¨Έμ§€**λ¥Ό μλ―Έν•λ‹¤.   
    μ΄λ• λ‚λ¨Έμ§€λ” ν•­μƒ $(\{0, 1, 2, 3, ..., q-1\}\)$ μ‚¬μ΄μ κ°’μ΄λ‹¤.
    - μ: $7 \bmod 5 = 2$   

  - **λ¨λ“λ¬μ¤ (modulus)**: $a \bmod q$κ°€ μ£Όμ–΄μ΅μ„ λ•, divisor <b>q</b>λ¥Ό λ¨λ“λ¬μ¤λΌ λ¶€λ¥Έλ‹¤.   
    λ°λ©΄, **λ¨λ“λ¬ (modulo)**λ” μ—°μ‚°(operation) μμ²΄λ¥Ό μλ―Έν•λ‹¤.   

  - **λ¨λ“λ¬ ν•©λ™μ‹ (Modulo Congruence)**: λ‘ μ •μ $a, b$κ°€ $q$λ΅ λ‚λ΄μ„ λ• κ°™μ€ λ‚λ¨Έμ§€λ¥Ό κ°€μ§€λ©΄, $a$λ” $b$μ™€ λ¨λ“λ¬μ¤ $q$μ— λ€ν•΄ ν•©λ™μ΄λ‹¤.  
  $$
  a \equiv b \bmod q βΊ a = b \pmod q   
  $$  
    - μ) $5 \equiv 12 \bmod 7$
        - $5 \bmod 7 = 12 \bmod 7 = 5$
    * μ£Όμ: $b$λ¥Ό $q$λ΅ λ‚λ„μ—μ„ λ• λ‚λ¨Έμ§€ $a$λ¥Ό λ»ν•λ” $a = b \bmod q$ μ‹κ³Όλ” λ‹¤λ¥΄λ‹¤.     

  - **ν•©λ™μ‹ vs λ™μΉ (Congruence vs Equality)**:   
    μ„μμ μ •μ $k$μ— λ€ν•΄μ„,   
    $$
    a \equiv b \bmod q βΊ a = b + k \cdot q   
    $$    
    β†’ μ¦‰, $a$μ™€ $b$λ” **$q$μ μ •μλ°°λ§νΌ μ°¨μ΄**κ°€ μμ„ λ•, λ¨λ“λ¬μ¤ $q$μ— λ€ν•΄ μ„λ΅ ν•©λ™μ΄λ‹¤.   
      - μ) $5 \equiv 12 \bmod 7 βΊ 5 = 12 + (-1) \cdot 7$

  </div>
</div>
---

### 2) λ¨λ“λ¬ μ‚°μ  (Modulo Arithmetic)   

<div style="margin-left:20px; border:2px solid #007acc; border-radius:6px; background:#f0f8ff; margin:12px 0; width:95%; font-size:0.95em;">

  <div style="background:#007acc; color:white; font-weight:bold; padding:8px 12px; border-radius:4px 4px 0 0;">
    π“ [Theorem A-1.2.1] Properties of Modulo Operations (λ¨λ“λ¬ μ—°μ‚° μ„±μ§)
  </div>

  <div style="padding:12px 15px;" markdown="1">
  
  - λ¨λ“  μ •μ $x$μ— λ€ν•΄μ„, λ‹¤μμ΄ μ„±λ¦½ν•λ‹¤:
    1. **Addition (λ§μ…)**: $a \equiv b \bmod q βΊ a + x \equiv b + x \bmod q$   
    2. **Subtraction (λΊ„μ…)**: $a \equiv b \bmod q βΊ a - x \equiv b - x \bmod q$   
    3. **Multiplication (κ³±μ…)**: $a \equiv b \bmod q βΊ a \cdot x \equiv b \cdot x \bmod q$   

  </div>
</div>

<details style="margin-left:20px;">
  <summary>π“ <b>Proof (μ¦λ…)</b></summary>
  <div style="border:2px solid #007acc; border-radius:6px; padding:12px 15px; background:#f0f8ff; margin:12px 0; width:95%; font-size:0.95em;" markdown="1">

  - λ¨λ“  μ •μ $x$μ— λ€ν•μ—¬ λ‹¤μμ΄ μ„±λ¦½ν•λ‹¤:   
  
    1. Addition (λ§μ…):    
      $a \equiv b \bmod q$ 
        βΊ $a = b+kq$ (μ„μμ $k$μ— λ€ν•΄) <span style="color:red"># μ΄λ• $a, b$λ” $q$μ λ°°μ μ°¨μ΄λ¥Ό κ°€μ§</span>      
        βΊ $a + x = b+k \cdot q + x$    
        βΊ $a + x = b+x + k \cdot q$ <span style="color:red"># $a + x, b + x$λ” $q$μ λ°°μ μ°¨μ΄λ¥Ό κ°€μ§</span>    
        βΊ $a + x \equiv b + x \bmod q$    
  
    2. Subtraction (λΊ„μ…):     
      $a \equiv b \bmod q$ 
        βΊ $a = b+kq$ (μ„μμ $k$μ— λ€ν•΄)  
        βΊ $a - x = b+k \cdot q - x$    
        βΊ $a - x = b-x + k \cdot q$ <span style="color:red"># $a - x, b - x$λ” $q$μ λ°°μ μ°¨μ΄λ¥Ό κ°€μ§</span>     
        βΊ $a - x \equiv b - x \bmod q$    

    3. Multiplication (κ³±μ…):     
      $a \equiv b \bmod q$ 
        βΊ $a = b+kq$ (μ„μμ $k$μ— λ€ν•΄)  
        βΊ $a \cdot x = b+k \cdot q \cdot x$    
        βΊ $a \cdot x = b \cdot x + k_{x} \cdot q$ ($k_{x}=k \cdot x$ μΌ λ•)<span style="color:red"># $a \cdot x, b \cdot x$λ” $q$μ λ°°μ μ°¨μ΄λ¥Ό κ°€μ§</span>     
        βΊ $a \cdot x \equiv b \cdot x \pmod q$    

  </div>
</details>

<div style="margin-left:20px; border:2px solid #007acc; border-radius:6px; background:#f0f8ff; margin:12px 0; width:95%; font-size:0.95em;">

  <div style="background:#007acc; color:white; font-weight:bold; padding:8px 12px; border-radius:4px 4px 0 0;">
    π“ [Theorem A-1.2.2] Properties of Modulo Arithmetic (λ¨λ“λ¬ μ‚°μ  μ„±μ§)
  </div>

  <div style="padding:12px 15px;" markdown="1">
  
  1. **Associative (κ²°ν•©λ²•μΉ™)**: $(a \cdot b) \cdot c \equiv a \cdot (b \cdot c) \bmod q$   
  2. **Commutative (κµν™λ²•μΉ™)**: $(a \cdot b) \equiv (b \cdot a) \bmod q$   
  3. **Distributive (λ¶„λ°°λ²•μΉ™)**: $(a \cdot (b+c)) \equiv ((a \cdot b) + (a \cdot c)) \bmod q$   
  4. **Interchangeable (μΉν™ κ°€λ¥μ„±)**: λ¨λ“λ¬ μ‚°μ μ—μ„λ” **ν•©λ™ κ΄€κ³„μ— μλ” κ°’ (congruent values)** μ€ μ—°μ‚°μ—μ„ **μ„λ΅ μμ λ΅­κ² μΉν™ κ°€λ¥**ν•λ‹¤.  
    - $(a \equiv b \bmod q)$μ™€ $(c \equiv d \bmod q)$μΌ κ²½μ°, λ‹¤μμ΄ λ¨λ‘ μ„±λ¦½ν•λ‹¤:  
      - $(a+c) \equiv (b+d) \equiv (a+d) \equiv (b+c) \bmod q$    
      - $(a-c) \equiv (b-d) \equiv (a-d) \equiv (b-c) \bmod q$   
      - $(a \cdot c) \equiv (b \cdot d) \equiv (a \cdot d) \equiv (b \cdot c) \bmod q$     
  </div>
</div>

<div style="margin-left:20px; border:2px solid #007acc; border-radius:6px; background:#f0f8ff; margin:12px 0; width:95%; font-size:0.95em;">

  <div style="background:#007acc; color:white; font-weight:bold; padding:8px 12px; border-radius:4px 4px 0 0;">
    π“ [Definition A-1.2.1] Inverse in Modulo Arithmetic (λ¨λ“λ¬ μ‚°μ μ—μ„μ μ—­μ›)
  </div>

  <div style="padding:12px 15px;" markdown="1">
  
  λ¨λ“λ¬ $q$ (μ¦‰, λ¨λ“  μλ¥Ό $q$λ΅ λ‚λ λ‚λ¨Έμ§€μ μ„Έκ³„)μ—μ„, κ° $a in {0, 1, 2, ..., q-1}$μ— λ€ν•΄ λ‹¤μκ³Ό κ°™μ΄ μ •μλλ‹¤.   
  1. **Additive Inverse (λ§μ… μ—­μ›)**: $a_{+}^{-1}$μ€ λ‹¤μμ„ λ§μ΅±ν•λ” μμ΄λ‹¤.    
  $$
  a + a_{+}^{-1} \equiv 0 \bmod q   
  $$    
    - μ. λ¨λ“λ¬ $11$μ—μ„ $3_{+}^{-1}=8$ β†’ μ™λƒν•λ©΄ $3 + 8 \equiv 0 \bmod 11$μ΄κΈ° λ•λ¬Έμ΄λ‹¤.    

  2. **Multiplicative Inverse (κ³±μ… μ—­μ›)**: $a_{\*}^{-1}$μ€ λ‹¤μμ„ λ§μ΅±ν•λ” μμ΄λ‹¤.    
  $$ 
  a \cdot a_{\*}^{-1} \equiv 1 \bmod q   
  $$    
    - μ. λ¨λ“λ¬ $11$μ—μ„ $3_{*}^{-1}=4$ β†’ μ™λƒν•λ©΄ $3 \cdot 4 \equiv 1 \bmod 11$μ΄κΈ° λ•λ¬Έμ΄λ‹¤.       
  </div>
</div>

- Modulo Division (λ¨λ“λ¬ λ‚λ—μ…)
  - λ¨λ“λ¬ μ‚°μ μ—μ„μ λ‚λ—μ…μ€ μΌλ°μ μΈ μν•™μ  λ‚λ—μ…κ³Όλ” λ‹¤λ¥΄λ‹¤. (μ—„λ°€ν λ§ν•λ©΄, <span style="color:red">*λ¨λ“λ¬ λ‚λ—μ…μ€ μ΅΄μ¬ν•μ§€ μ•λ”λ‹¤.*</span>) μ™λƒν•λ©΄ λ¨λ“λ¬ μ—°μ‚° μμ²΄κ°€ μ΄λ―Έ *λ‚λ¨Έμ§€λ¥Ό κµ¬ν•λ” μΌμΆ…μ λ‚λ—μ…*μ΄κΈ° λ•λ¬Έμ΄λ‹¤.  
  - ν•μ§€λ§ μ–΄λ–¤ μ $b$λ¥Ό $a$λ΅ "λ¨λ“λ¬ λ‚λ„κΈ°" ν•κ³ μ ν•λ‹¤λ©΄, μ΄λ” κ³§ $a$μ **λ¨λ“λ¬ μ—­μ› (modular inverse)**μ„ μ΄μ©ν• κ³±μ…μΌλ΅ ν‘ν„ν•  μ μλ‹¤. 
    $$
    b \div a \bmod q \; \equiv \; b \cdot a_{*}^{-1} \bmod q
    $$  
    μ¦‰, *λ¨λ“λ¬ λ‚λ—μ…(modulo division)*μ€ **λ¨λ“λ¬ κ³±μ… (modulo multiplication)**μΌλ΅ μ •μλλ‹¤.   

    π“ **μ¤‘μ”ν• μ°¨μ΄μ :**  
      - μΌλ°μ μΈ λ‚λ—μ…μ€ μ‹¤μ(real number)λ¥Ό κ²°κ³Όλ΅ λ‚΄μ§€λ§,    
        λ¨λ“λ¬ λ‚λ—μ…μ€ ν•­μƒ **μ •μ(integer)**λ¥Ό κ²°κ³Όλ΅ λ‚Έλ‹¤.    
        (μ΄λ” $b$μ™€ $a_{*}^{-1}$ λ¨λ‘ μ •μμ΄κΈ° λ•λ¬Έ)   

  - λ§μ§€λ§‰μΌλ΅, μ •μ $a$μ **λ¨λ“λ¬ μ—­μ›**μ€ *ν™•μ¥ μ ν΄λ¦¬λ“ μ•κ³ λ¦¬μ¦ (Extended Euclidean Algorithm)*μ„ μ΄μ©ν•΄ κ³„μ‚°ν•  μ μλ‹¤.   

- Centered Residue Representation  
  - *Canonicalμ€ 0λ¶€ν„° μ‹μ‘ν•λ” μ”μ—¬κ³„, Centeredλ” 0μ„ κΈ°μ¤€μΌλ΅ λ€μΉ­μΈ μ”μ—¬κ³„λ‹¤*

    μ§€κΈκΉμ§€ **μ”μ—¬(λ‚λ¨Έμ§€, Residue)**λ¥Ό *μ–‘μ μ •μ(positive integer)*λΌκ³  κ°€μ •ν–λ‹¤. 
    - λ¨λ“λ¬ $q$μ—μ„ κ°€λ¥ν• λ‚λ¨Έμ§€ μ§‘ν•©μ€ λ‹¤μκ³Ό κ°™λ‹¤.   
      $$
      {0, 1, 2, \dots q-1}   
      $$   

      β†’ μ΄ ν‘ν„ λ°©μ‹μ„ **ν‘μ¤€ μ”μ—¬κ³„(canonical residue system)** λλ” **λΉ„λ¶€νΈν• μ”μ—¬ ν‘ν„ (unsigned residue representation)** μ΄λΌκ³  λ¶€λ¥Έλ‹¤.

      π”Έ ν•μ§€λ§ λ λ‹¤λ¥Έ ν‘ν„ λ°©μ‹λ„ μ΅΄μ¬ν•λ‹¤.  
        λ°”λ΅ **λ¶€νΈν• μ”μ—¬κ³„ (signed or centered residue system)** λ΅, μ”μ—¬λ“¤μ΄ 0μ„ μ¤‘μ‹¬μΌλ΅ λ€μΉ­λκ² λ¶„ν¬ν•λ‹¤.
      $$
      {-\frac{q}{2}, -frac{q}{2}+1, \dots, 0, \dots, frac{q}{2}-2, \frac{q}{2}-1}   
      $$   

      β†’ λΉ„λ¶€νΈν• μ”μ—¬κ³„λ‚ λ¶€νΈν• μ”μ—¬κ³„ λ¨λ‘ *μ”μ—¬μ κ°μλ” λ™μΌν•κ² $q$κ°*μ΄λ‹¤. μ°¨μ΄λ” λ‹¨μ§€ **μ”μ—¬ λ²”μ„μ κΈ°μ¤€μ (upper/lower bound)**μ— μλ‹¤.   

      <table style="border-collapse:collapse; width:95%; text-align:center; font-size:0.9em;">
        <thead style="background:#e0efff; font-weight:bold;">
          <tr>
            <td>ν‘ν„ λ°©μ‹</td>
            <td>μ”μ—¬ μ§‘ν•©</td>
            <td>ν•ν•(lower bound)</td>
            <td>μƒν•(upper bound)</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Canonical (Unsigned)</td>
            <td>$\{0, 1, 2, \dots, q-1\}$</td>
            <td>0</td>
            <td>$q-1$</td>
          </tr>
          <tr>
            <td>Centered (Signed)</td>
            <td>$\{-\frac{q}{2}, \dots, 0, \dots, \frac{q}{2}-1\}$</td>
            <td>$-\frac{q}{2}$</td>
            <td>$\frac{q}{2}-1$</td>
          </tr>
        </tbody>
      </table>
    
      π’΅ **λ¨λ“λ¬ μ—°μ‚°μ μ—­ν• **  
      λ¨λ“λ¬ μ—°μ‚°μ€ μ£Όμ–΄μ§„ κ°’μ„ μ„ λ‘ μ‹μ¤ν… μ¤‘ ν•λ‚μ μ”μ—¬ λ²”μ„λ΅ λ³€ν™ν•λ‹¤.  

      - κ°’μ΄ **μƒν•λ³΄λ‹¤ ν¬λ©΄** β†’ λ¨λ“λ¬μ¤ $q$λ¥Ό **λΉΌμ¤€λ‹¤**  
      - κ°’μ΄ **ν•ν•λ³΄λ‹¤ μ‘μΌλ©΄** β†’ λ¨λ“λ¬μ¤ $q$λ¥Ό **λ”ν•΄μ¤€λ‹¤**

      β†’ λ”°λΌμ„ λ‘ μ‹μ¤ν…μ μ°¨μ΄λ” λ‹¨μ§€ μ”μ—¬μ β€ν‘ν„ λ°©μ‹β€μΌ λΏ, λ¨λ‘ λ™μΌν• λ¨λ“λ¬ μ§‘ν•© $\mathbb{Z}_q$λ¥Ό λ‚νƒ€λ‚Έλ‹¤.   

      $$
      \mathbb{Z}_q = \{0, 1, 2, \dots, q - 1\}
      $$    
  
  - Canonicalκ³Ό Centered μ”μ—¬κ³„λ” λ¨λ“  μ—°μ‚° μ„±μ§μ΄ λ™μΌν•κ² μ μ§€λλ‹¤.   

    ν‘μ¤€ μ”μ—¬κ³„(canonical system)μ™€ μ¤‘μ‹¬ μ”μ—¬κ³„(centered system)λ” **λ§μ… $\cdot$ λΊ„μ… $\cdot$ κ³±μ… $\cdot$ λ‚λ—μ…μ λ¨λ“  λ¨λ“λ¬ μ„±μ§**μ€ λ™μΌν•κ² μ„±λ¦½ν•λ‹¤.

    $$
    (a \pm b) \bmod q, \quad (a \times b) \bmod q, \quad (a \div b) \bmod q
    $$   

    β†’ μ΄λ“¤μ΄ μ–΄λ–¤ μ”μ—¬κ³„μ—μ„ κ³„μ‚°λλ“  κ²°κ³Όμ λ™μΉ κ΄€κ³„λ” λ³€ν•μ§€ μ•λ”λ‹¤.  

      π’΅ **μ΄μ :**  
      λ‘ μ‹μ¤ν… λ¨λ‘ κ°™μ€ λ¨λ“λ¬μ¤ $q$λ¥Ό μ‚¬μ©ν•κΈ° λ•λ¬Έμ—,  
      **μ–΄λ–¤ λ‘ λ™μΉ μ”μ—¬(congruent residues)**λΌλ„ μ„λ΅ **$kq$μ μ°¨μ΄**λ¥Ό κ°€μ§„λ‹¤.  
      μ¦‰,  
      $$
      a \equiv b \pmod q \quad \Rightarrow \quad a - b = kq \quad (k \in \mathbb{Z})
      $$    

    β†’ λ”°λΌμ„ canonical ν‘ν„μ΄λ“  centered ν‘ν„μ΄λ“ , κ° μ—°μ‚°μ κ²°κ³Όλ” ν•­μƒ **κ°™μ€ λ™μΉλ¥(congruence class)**μ— μ†ν•κ² λλ‹¤.   

  - Canonicalκ³Ό Centered μ”μ—¬κ³„μ μ—°μ‚° μ„±μ§ μ¤‘ μ—­μ›λ„ λ™μΌν•κ² μ μ§€λλ‹¤.  
    
    λ¨λ“λ¬ $q$μ—μ„ $a$μ μ—­μ›μ€ λ‹¤μμ„ λ§μ΅±ν•λ‹¤.  

    $$
    a \cdot a^{-1} \equiv 1 \pmod q
    $$

    π”Ή **λ¶€νΈν•(signed) μ”μ—¬ ν‘ν„μ„ μ‚¬μ©ν•λ” μ΄μ **λ” νΉμ • μƒν™©μ—μ„ **λ¨λ“λ¬ μ—°μ‚°μ„ μƒλµν•  μ μμ„ μ •λ„λ΅ κ³„μ‚°μ„ λ‹¨μν™”ν•  μ μκΈ° λ•λ¬Έ**μ΄λ‹¤.  

    ---
    #### π§© μμ  1. Canonical (Unsigned) Representation
    ν‘μ¤€ μ”μ—¬κ³„μ—μ„λ”   
    $$
    (a + b) \bmod q
    $$
    μ ν•νƒλ¥Ό κ°€μ •ν•μ.  
    λ§μ•½ μ–΄λ–¤ μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ **ν•­μƒ $0 \le a + b \le q - 1$** μ΄λΌλ” μ΅°κ±΄μ΄ λ³΄μ¥λλ‹¤λ©΄,   

    $$
    (a + b) \bmod q = a + b
    $$

    λ”°λΌμ„ **λ¨λ“λ¬ μ—°μ‚°μ„ μƒλµ**ν•  μ μλ‹¤.    
    (μ¦‰, κ°’μ΄ μ”μ—¬ λ²”μ„ $[0, q-1]$λ¥Ό λ²—μ–΄λ‚μ§€ μ•κΈ° λ•λ¬Έ)    

    ---
    #### π§© μμ  2. Centered (Signed) Representation
    μ΄λ²μ—λ” μ¤‘μ‹¬ μ”μ—¬κ³„μ—μ„  
    $$
    (a - b) \bmod q
    $$
    λ¥Ό μƒκ°ν•μ.  
    λ§μ•½ $a - b$κ°€ ν•­μƒ **$[-\frac{q}{2}, \frac{q}{2} - 1]$** λ²”μ„ μ•μ— μλ‹¤λ©΄,

    $$
    (a - b) \bmod q = a - b
    $$

    μ΄λ•λ„ **λ¨λ“λ¬ μ—°μ‚°μ„ μƒλµ**ν•  μ μλ‹¤.   

    ---
    #### β οΈ μ£Όμ: Canonical ν‘ν„μ—μ„μ λΊ„μ…
    λ§μ•½ μ„μ™€ κ°™μ€ $(a - b) \bmod q$ μ—°μ‚°μ„ **canonical ν‘ν„**μΌλ΅ κ³„μ‚°ν•λ‹¤λ©΄,   
    $a - b$κ°€ μμμΌ κ²½μ° κ·Έ κ°’μ€ ν•ν•(0)λ³΄λ‹¤ μ‘μ•„μ§„λ‹¤.  
    μ΄ κ²½μ° λ¨λ“λ¬μ¤ $q$λ¥Ό **ν•λ‚ μ΄μƒ λ”ν•΄μ£Όλ”(modulo reduction)** λ³΄μ •μ΄ ν•„μ”ν•λ‹¤.   

    μλ¥Ό λ“¤μ–΄,  
    $$
    a = 3, \quad b = 7, \quad q = 11
    $$  
    μ΄λ©΄  
    $$
    (a - b) \bmod 11 = (3 - 7) \bmod 11 = (-4) \bmod 11 = 7
    $$  

    β… **μ •λ¦¬:**  
    - canonical ν‘ν„: μμκ°€ λλ©΄ λ°λ“μ‹ λ¨λ“λ¬ λ³΄μ • ν•„μ”  
    - centered ν‘ν„: Β±λ²”μ„ μ•μ΄λ©΄ λ¨λ“λ¬ λ³΄μ • μ—†μ΄ μ—°μ‚° κ°€λ¥  

    μ¦‰, **λ¶€νΈν•(centered) μ”μ—¬ ν‘ν„μ€ λ§μ…λ³΄λ‹¤ λΊ„μ… μ—°μ‚°μ—μ„ λ” μ§κ΄€μ μ΄λ©° ν¨μ¨μ **μ΄λ‹¤.   

  - Β§D-5.8 μ μ—μ„λ” **centered residue representationμ μ λ¦¬ν• μ„±μ§**μ„ ν™μ©ν•μ—¬ **FastBConvEx μ—°μ‚°(Fast Balanced Convolution Extension)** μ„ μ„¤κ³„ν•λ‹¤.   

    - μ΄ μ•κ³ λ¦¬μ¦μ—μ„λ” λ‹¤μκ³Ό κ°™μ€ κ΄€κ³„κ°€ μ„±λ¦½ν•λ‹¤.

    $$
    (\mu + u) \bmod b^{\alpha}
    $$

    μΌλ°μ μΌλ΅λ” λ¨λ“λ¬ μ—°μ‚°μ΄ ν•„μ”ν•μ§€λ§,  
    μ΄λ• $\mu + u$κ°€ ν•­μƒ **centered residue λ²”μ„ λ‚΄**μ— μ΅΄μ¬ν•¨μ΄ λ³΄μ¥λλ‹¤.

    $$
    -\frac{b^{\alpha}}{2} \leq \mu + u < \frac{b^{\alpha}}{2}
    $$

    λ”°λΌμ„,
    $$
    (\mu + u) \bmod b^{\alpha} = \mu + u
    $$

    μ¦‰, **λ¨λ“λ¬ μ—°μ‚°μ„ μƒλµ**ν•κ³  λ‹¨μ λ§μ…μΌλ΅ ν‘ν„ν•  μ μλ‹¤.  
    μ΄λ” μ—°μ‚°μ„ κ°„μ†ν™”ν•κ³  κ³„μ‚° ν¨μ¨μ„ λ†’μ΄λ” ν•µμ‹¬ μ•„μ΄λ””μ–΄μ΄λ‹¤.   

    π’΅ **ν•µμ‹¬ ν¬μΈνΈ:**  
    - centered residue ν‘ν„μ„ μ‚¬μ©ν•λ©΄,  
      κ°’μ΄ μ”μ—¬ λ²”μ„λ¥Ό λ²—μ–΄λ‚μ§€ μ•λ” ν• λ¨λ“λ¬ μ²λ¦¬κ°€ λ¶ν•„μ”ν•λ‹¤.  
    - μ΄ νΉμ„±μ€ **κ³ μ† μ•”νΈ μ—°μ‚°(μ: FastBConvEx)** μ„¤κ³„ μ‹  
      λ¶ν•„μ”ν• λ‚λ¨Έμ§€ κ³„μ‚°μ„ μ κ±°ν•μ—¬ μ„±λ¥μ„ μµμ ν™”ν•λ” λ° μ‚¬μ©λλ‹¤.  

  </div>
</details>

---
